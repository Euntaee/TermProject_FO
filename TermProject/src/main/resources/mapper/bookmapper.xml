<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
         PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.project.demo.dao.BookDAO">
     
    <!-- 책 리스트 출력 -->
	<select id="selectBookList" resultType="com.project.demo.vo.BookVO" parameterType="java.util.Map" >
	SELECT 
	   book_no, 
       book_title, 
       book_img, 
       book_author,
       book_publish
    FROM book    
    ORDER BY book_no ASC 
    limit #{start}, #{end}
    </select>
       
    <!-- 총 페이지 -->
    <select id="selectTotalPage" resultType="int" parameterType="java.util.Map">
    SELECT CEIL(COUNT(*)/12.0)
    FROM book
    </select>
    
    <!-- 책 검색 리스트 출력 -->
    <select id="findBookList" resultType="com.project.demo.vo.BookVO" parameterType="java.util.Map">    
    SELECT 
     book_no, 
     book_title, 
     book_img, 
     book_author,
     book_publish
    FROM book              
    WHERE
       <!-- <choose>
          <when test='st == "T".toString()'>
              book_title like CONCAT('%',#{searchtext},'%')
          </when>
          <when test='st == "A".toString()'>
              book_author like CONCAT('%',#{searchtext},'%')
          </when>    
          <when test='st == "TA".toString()'>
              book_author like CONCAT('%',#{searchtext},'%') OR book_title like CONCAT('%',#{searchtext},'%')
          </when>          
      </choose>    -->
       <if test='st=="T"'>
         book_title LIKE CONCAT('%',#{searchtext},'%')
       </if>
       <if test='st=="A"'>
         book_author LIKE CONCAT('%',#{searchtext},'%')
       </if>  
       <if test='st=="TA"'>
         book_author LIKE CONCAT('%',#{searchtext},'%') OR book_title LIKE CONCAT('%',#{searchtext},'%')
       </if>                
    </select>            
    
    <!-- 상세보기. -->
    <select id="detailBook" resultType="com.project.demo.vo.BookVO" parameterType="String">
    SELECT
     book_no, 
     book_title, 
     book_img, 
     book_author,
     book_publish,
     book_content,
     book_publish,
     book_genre
    FROM book
    WHERE book_no=#{book_no}
    </select>
</mapper>